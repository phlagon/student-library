<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Theological Library</title>

<!-- Firebase Compat -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
body{font-family:Poppins,Arial;background:#f1f5f9;margin:0;padding:0}
.center{min-height:100vh;display:flex;align-items:center;justify-content:center}
.card{background:#fff;padding:30px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.1);width:100%;max-width:360px;text-align:center}
.btn{background:#2563eb;color:#fff;border:none;padding:14px;border-radius:12px;width:100%;font-weight:600;cursor:pointer}
.btn:active{transform:scale(.98)}
.hidden{display:none}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen" class="center">
  <div class="card">
    <h2>Jesus is the Saviour</h2>
    <p>Theological Student Library</p>
    <button class="btn" onclick="googleLogin()">Login with Google</button>
    <p id="status" style="font-size:12px;color:#555;margin-top:10px"></p>
  </div>
</div>

<!-- DASHBOARD -->
<div id="appScreen" class="hidden">
  <div style="padding:20px">
    <h3>Welcome</h3>
    <p id="userName"></p>
    <button class="btn" style="background:#ef4444" onclick="logout()">Logout</button>
  </div>
</div>

<script>
/* ========== FIREBASE CONFIG ========== */
const firebaseConfig = {
  apiKey: "AIzaSyBBZ5Yvd7XH4lymNq2vIp-cwxPba55upWg",
  authDomain: "student-library-4a4e7.firebaseapp.com",
  projectId: "student-library-4a4e7",
  storageBucket: "student-library-4a4e7.firebasestorage.app",
  messagingSenderId: "827419448917",
  appId: "1:827419448917:web:4b0d1084e6f1fe1b2566dc"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

/* ========== GOOGLE LOGIN (POPUP) ========== */
async function googleLogin(){
  const provider = new firebase.auth.GoogleAuthProvider();
  document.getElementById("status").innerText = "Opening Google login...";

  try{
    const result = await auth.signInWithPopup(provider);
    console.log("Logged in:", result.user.email);
  }catch(err){
    console.error(err);

    if(err.code === "auth/popup-blocked"){
      document.getElementById("status").innerText = "Popup blocked! Please allow popups and try again.";
    }else if(err.code === "auth/unauthorized-domain"){
      document.getElementById("status").innerText = "This domain is not authorized in Firebase.";
    }else{
      document.getElementById("status").innerText = err.message;
    }
  }
}

/* ========== AUTH STATE ========== */
auth.onAuthStateChanged(user=>{
  if(user){
    document.getElementById("loginScreen").classList.add("hidden");
    document.getElementById("appScreen").classList.remove("hidden");
    document.getElementById("userName").innerText = 
      "Logged in as: " + (user.displayName || user.email);
  }else{
    document.getElementById("loginScreen").classList.remove("hidden");
    document.getElementById("appScreen").classList.add("hidden");
  }
});

/* ========== LOGOUT ========== */
function logout(){
  auth.signOut();
}
</script>

</body>
</html>
